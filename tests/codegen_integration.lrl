;; Integration smoke: higher-order calls through local closures.

(def my_add_local (pi n Nat (pi m Nat Nat))
  (lam n Nat
    (lam m Nat
      (match n Nat
        (case (zero) m)
        (case (succ k ih) (succ ih))))))

(def make_adder (pi x Nat (pi y Nat Nat))
  (lam x Nat (lam y Nat (my_add_local x y))))

(def add_two (pi y Nat Nat)
  (make_adder (succ (succ zero))))

(def apply_fn (pi f (pi x Nat Nat) (pi v Nat Nat))
  (lam f (pi x Nat Nat)
    (lam v Nat (f v))))

(def test_apply Nat
  (apply_fn add_two (succ zero)))

(add test_apply zero)
