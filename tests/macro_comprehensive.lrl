;; Macro system smoke with backend-neutral Nat expressions.

(defmacro let1 (name ty value body)
  (let name ty value body))

(defmacro add_one (x)
  (quasiquote (add (unquote x) (succ zero))))

(def base Nat (succ (succ zero)))

(def via_macro Nat
  (add_one base))

(def y Nat
  (let1 tmp Nat via_macro
    (add tmp (succ zero))))

(add via_macro y)
